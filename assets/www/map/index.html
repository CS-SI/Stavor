<html><body>
  <div id="mapdiv"></div>
  <script src="http://www.openlayers.org/api/OpenLayers.js"></script>
  <script>
    	map = new OpenLayers.Map("mapdiv");
    	map.addLayer(new OpenLayers.Layer.OSM());

 	
	    var lonLat = new OpenLayers.LonLat( 0.0 ,0.0 )
		  .transform(
		    new OpenLayers.Projection("EPSG:4326"), // transform from WGS 1984
		    map.getProjectionObject() // to Spherical Mercator Projection
		  );
 
   	var zoom=0;

	map.setCenter (lonLat, zoom);
 /*
    var markers = new OpenLayers.Layer.Markers( "Markers" );
    map.addLayer(markers);
 
    markers.addMarker(new OpenLayers.Marker(lonLat));
 
    
*/
	var lineLayer = new OpenLayers.Layer.Vector("Line Layer"); 

	map.addLayer(lineLayer);                    
	map.addControl(new OpenLayers.Control.DrawFeature(lineLayer, OpenLayers.Handler.Path));                                     
	var points = new Array(
	   new OpenLayers.Geometry.Point(1.0, 1.0).transform(new OpenLayers.Projection("EPSG:4326"), map.getProjectionObject()),
	   new OpenLayers.Geometry.Point(20.0, 20.0).transform(new OpenLayers.Projection("EPSG:4326"), map.getProjectionObject()),
	   new OpenLayers.Geometry.Point(20.0, 30.0).transform(new OpenLayers.Projection("EPSG:4326"), map.getProjectionObject()),
	   new OpenLayers.Geometry.Point(20.0, 40.0).transform(new OpenLayers.Projection("EPSG:4326"), map.getProjectionObject()),
	   new OpenLayers.Geometry.Point(40.0, 40.0).transform(new OpenLayers.Projection("EPSG:4326"), map.getProjectionObject())
	);

	var line = new OpenLayers.Geometry.LineString(points);

	var style = { 
	  strokeColor: '#ff0000', 
	  strokeOpacity: 0.5,
	  strokeWidth: 3
	};

	var lineFeature = new OpenLayers.Feature.Vector(line, null, style);
	lineLayer.addFeatures([lineFeature]);

	function clearPath(){
		points = new Array();
		reDraw();
	}
	function addPoint(lat, lon){
		points.push(new OpenLayers.Geometry.Point(lon, lat).transform(new OpenLayers.Projection("EPSG:4326"), map.getProjectionObject()));
		reDraw();
	}
	function addPoints(points_ext){
		var points_ext_ol = new Array();
		for (var arrayIndex in points_ext) {
			points_ext_ol.push(new OpenLayers.Geometry.Point(points_ext[arrayIndex][1], points_ext[arrayIndex][0]).transform(new OpenLayers.Projection("EPSG:4326"), map.getProjectionObject()));
		}
		points = points.concat(points_ext_ol);
		reDraw();
	}
	function reDraw(){
		line = new OpenLayers.Geometry.LineString(points);
		lineLayer.removeAllFeatures();
		var lineFeature = new OpenLayers.Feature.Vector(line, null, style);
		lineLayer.addFeatures([lineFeature]);
	}

function reloadModel(){
	//clearPath();
	setLoadingProgress(100);
}
function updateModelState(new_state){
	var state = JSON.parse(new_state);
	addPoints(new_state);
}
function showAndroidToast(toast) {
	if (typeof Android != "undefined"){ // check the bridge 
		  if (Android.showToast!= "undefined") { // check the method
			 Android.showToast(toast);
		  }
   	}
}
function setLoadingProgress(progress) {// from 0 to 100 
	if (typeof Android != "undefined"){ // check the bridge 
		  if (Android.setProgressMap!= "undefined") { // check the method
			 Android.setProgressMap(progress);
		  }
   	}
}
function setLoaded() {// from 0 to 100 
	if (typeof Android != "undefined"){ // check the bridge 
		  if (Android.setProgressMap!= "undefined") { // check the method
			 Android.setProgressMap(100);
		  }
   	}
}
  </script>
</body></html>
