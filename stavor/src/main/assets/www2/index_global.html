<!doctype html>
<html lang="en">
<head>
	<title>STAVOR v3.0.0</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, height=device-height, target-densitydpi=device-dpi, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<link rel="icon" href="style/icons/capsule.png" />
	<link rel="stylesheet" href="style/css/main.css"/>
	<link rel="stylesheet" href="style/css/toolbar.css"/>
	<link rel="stylesheet" href="style/css/tabs.css"/>
	<link rel="stylesheet" href="style/css/missions.css"/>
	<link rel="stylesheet" href="style/css/views.css"/>
	<link rel="stylesheet" href="style/css/map.css"/>
	<link rel="stylesheet" href="style/css/leds.css"/>
    <link rel="stylesheet" href="style/css/OpenLayers/style.css" type="text/css">
    <link rel="stylesheet" href="style/css/OpenLayers/style.mobile.css" type="text/css">
	
	<!-- IntelXDK -->
	<!--<script src='intelxdk.js'></script>-->
    <!--<script src='xhr.js'></script>--><!-- Same origin policy -->
	
	<!-- HammerJs -->
	<script type="text/javascript" src="js/Gestures/hammer.min.js"></script>
	<!-- JSColor -->
	<script type="text/javascript" src="js/jscolor/jscolor.js"></script>
	<!-- jQuery -->
	<script type='text/javascript' src="js/jQuery/jquery-2.1.3.min.js"></script>
	<!-- ThreeJS -->
	<script type='text/javascript' src="js/ThreeJS/three.js"></script>
	<script type='text/javascript' src="js/ThreeJS/three.ext.js"></script>	
	<script type='text/javascript' src='js/ThreeJS/extensions/threex.planets.js'></script>
	<script type='text/javascript' src='js/ThreeJS/extensions/threex.atmospherematerial.js'></script>
	<script type='text/javascript' src="js/ThreeJS/extensions/threex.atmospheredatgui.js"></script>
	<script type='text/javascript' src="js/ThreeJS/extras/Detector.js"></script>
	<script type='text/javascript' src="js/ThreeJS/extras/Stats.js"></script>
	<!--<script src="js/OrbitControls.js"></script>-->
	<script type='text/javascript' src="js/ThreeJS/extras/TrackballControls.js"></script>
	<!--<script src="js/THREEx.KeyboardState.js"></script>
	<script src="js/THREEx.FullScreen.js"></script>
	<script src="js/THREEx.WindowResize.js"></script>-->
	<script type='text/javascript' src='js/ThreeJS/extras/DAT.GUI.min.js'></script>
	<script type='text/javascript' src="js/ThreeJS/shaders/ShaderEngine.js"></script><!-- SC engine plasma -->
	<script type='text/javascript' src="js/ThreeJS/shaders/ShaderGlow.js"></script><!-- Sun glow effect -->
	<script type='text/javascript' src="js/ThreeJS/shaders/ShaderSun.js"></script><!-- Sun surface -->
	
	<!-- OpenLayers -->
	<!--<script type='text/javascript' src="js/OpenLayers/OpenLayers.js"></script>-->
	<script type='text/javascript' src="js/OpenLayers/OpenLayers.mobile.js"></script>
	
	<!-- Orekit -->
	<script type='text/javascript' src="modules/simulator/orekit/orekit-data.js"></script>
	<!-- Stavor -->
	<script type='text/javascript' src="js/Stavor/parameters.js"></script>
	<script type='text/javascript' src="js/Stavor/constants.js"></script>
	<script type='text/javascript' src="js/Stavor/enums.js"></script>
	<script type='text/javascript' src="js/Stavor/variables.js"></script>
	<script type='text/javascript' src="js/Stavor/menus.js"></script>
	<script type='text/javascript' src="js/Stavor/gestures.js"></script>
	
	<script type='text/javascript' src="modules/simulator/components/KeplerianOrbit.js"></script>
	<script type='text/javascript' src="modules/simulator/components/SimDate.js"></script>
	<script type='text/javascript' src="modules/simulator/components/Mission.js"></script>
	<script type='text/javascript' src="js/Stavor/database.js"></script>
	<script type='text/javascript' src="js/Stavor/missions.js"></script>
	<!--<script type='text/javascript' src="js/Stavor/stations.js"></script>-->
	
	<script type="text/javascript"><!-- GLOBAL FUNCTIONS -->
		var global_orbit, global_attitude, global_map;
		var start_time;
		window.onload = function () {
			start_time = new Date().getTime();
				setLoadingText("Loading Configuration...");
			loadStoredVariables();
			
			global_attitude = new Attitude();//Splash
			global_orbit = new Orbit();//Splash
			global_map = new Map();//Splash
				setLoadingText("Init Visualizations...");
			initVisualizations();
				setLoadingText("Init Info Panel...");
			updateInfoPanel(true);
				setLoadingText("Init Option Menus...");
			initializeGlobalMenu();
			initializeAttitudeMenu();
			initializeOrbitMenu();
			initializeMapMenu();
				setLoadingText("Init Touch Controls...");
			initializePanGestures();
			initializeMissionsDb();//Splash
			drawMissionsList();
			
			loadOrekitFilesText();
		}
		
		function loadStoredVariables(){
			var serialized = localStorage.getItem('simulationConfig'); 
			if(serialized){
				var localData = JSON.parse(serialized);
				global_simulation.config = localData;
			}
		}
		function saveStoredVariables(){
			var dataToStore = JSON.stringify(global_simulation.config);
			localStorage.setItem('simulationConfig', dataToStore);
		}
		
		function resetStoredVariables(){
			localStorage.removeItem('simulationConfig'); 
			window.location.reload();
		}
		
		function resetConfiguration(){
			var r = confirm("Are you sure?");
			if (r == true) {
				resetStoredVariables();
			}
		}
		
		function error(text){
			alert(text);
		}
		function pushSimulationState(state){
			global_simulation.results = state;
		}
		
		//SplashScreen
		function hideSplash(){
			if(
				global_delayed_loading.visualization.attitude &&
				global_delayed_loading.visualization.orbit &&
				global_delayed_loading.visualization.map &&
				global_delayed_loading.database.missions
				){
				setLoadingText("Stavor loaded!");
				var current_time = new Date().getTime();
				var elapsed = current_time - start_time;
				var delay = parameters.splash_min_time - elapsed;
				if( delay < 0 ){
					delay = 0;
				}			
				setTimeout(function() { 					
					var div_splash = document.getElementById("Splash");
					div_splash.style.visibility = "hidden";
					div_splash.style.opacity = "0";
				}, delay);
			}else{
				//Wait for loading
				if(!global_delayed_loading.visualization.attitude){
					setLoadingText("Init Attitude module...");
				}else if(!global_delayed_loading.visualization.orbit){
					setLoadingText("Init Orbit module...");
				}else if(!global_delayed_loading.visualization.map){
					setLoadingText("Init Map module...");
				}else if(!global_delayed_loading.database.missions){
					setLoadingText("Loading Missions db...");
				}
			}
		}
		function setLoadingText(text){
			var div = document.getElementById("SplashLoading");
			div.innerHTML = text;
		}
		
		function initVisualizations(){
			global_current_visualization = enum_visualizations.ATTITUDE;
			updateLeds();
		}
		function updateLeds(){
			var led_attitude = document.getElementById("LedAttitude");
			var led_orbit = document.getElementById("LedOrbit");
			var led_map = document.getElementById("LedMap");
			
			if(global_current_visualization == enum_visualizations.ATTITUDE){
				led_attitude.className = "Led LedSelected";
				led_orbit.className = "Led LedUnselected";
				led_map.className = "Led LedUnselected";
			}else if(global_current_visualization == enum_visualizations.ORBIT){
				led_attitude.className = "Led LedUnselected";
				led_orbit.className = "Led LedSelected";
				led_map.className = "Led LedUnselected";
			}else if(global_current_visualization == enum_visualizations.MAP){
				led_attitude.className = "Led LedUnselected";
				led_orbit.className = "Led LedUnselected";
				led_map.className = "Led LedSelected";
			}else{
				error("ERROR: updateLeds(): the current visualization enum is not recognized.");
			}
		}
		function prevVisualization(){
			var div_attitude = document.getElementById("DivAttitude");
			var div_orbit = document.getElementById("DivOrbit");
			var div_map = document.getElementById("DivMap");
			
			var new_vis = enum_visualizations.ATTITUDE;
			if(global_current_visualization == enum_visualizations.ATTITUDE){
				div_attitude.style.display = "block";
				div_orbit.style.display = "none";
				div_map.style.display = "block";
				//Slide out Attitude
				$('#DivAttitude').animate({
					right: '-100%'
				},"slow");
				//Slide in Map
				div_map.style.right = "100%"; 
				$('#DivMap').animate({
					right: '0'
				},"slow");
				new_vis = enum_visualizations.MAP;
			}else if(global_current_visualization == enum_visualizations.ORBIT){
				div_attitude.style.display = "block";
				div_orbit.style.display = "block";
				div_map.style.display = "none";
				//Slide out Orbit
				$('#DivOrbit').animate({
					right: '-100%'
				},"slow");
				//Slide in Attitude
				div_attitude.style.right = "100%"; 
				$('#DivAttitude').animate({
					right: '0'
				},"slow");
				new_vis = enum_visualizations.ATTITUDE;
			}else if(global_current_visualization == enum_visualizations.MAP){
				div_attitude.style.display = "none";
				div_orbit.style.display = "block";
				div_map.style.display = "block";
				//Slide out Map
				$('#DivMap').animate({
					right: '-100%'
				},"slow");
				//Slide in Orbit
				div_orbit.style.right = "100%"; 
				$('#DivOrbit').animate({
					right: '0'
				},"slow");
				new_vis = enum_visualizations.ORBIT;
			}else{
				error("ERROR: prevVisualization(): the current visualization enum is not recognized.");
			}
			global_current_visualization = new_vis;
			updateLeds();
		}
		function nextVisualization(){
			var div_attitude = document.getElementById("DivAttitude");
			var div_orbit = document.getElementById("DivOrbit");
			var div_map = document.getElementById("DivMap");
			
			var new_vis = enum_visualizations.ATTITUDE;
			if(global_current_visualization == enum_visualizations.ATTITUDE){
				div_attitude.style.display = "block";
				div_orbit.style.display = "block";
				div_map.style.display = "none";
				//Slide out Attitude
				$('#DivAttitude').animate({
					right: '100%'
				},"slow");
				//Slide in Orbit
				div_orbit.style.right = "-100%"; 
				$('#DivOrbit').animate({
					right: '0'
				},"slow");
				new_vis = enum_visualizations.ORBIT;
			}else if(global_current_visualization == enum_visualizations.ORBIT){
				div_attitude.style.display = "none";
				div_orbit.style.display = "block";
				div_map.style.display = "block";
				//Slide out Orbit
				$('#DivOrbit').animate({
					right: '100%'
				},"slow");
				//Slide in Map
				div_map.style.right = "-100%"; 
				$('#DivMap').animate({
					right: '0'
				},"slow");
				new_vis = enum_visualizations.MAP;
			}else if(global_current_visualization == enum_visualizations.MAP){
				div_attitude.style.display = "block";
				div_orbit.style.display = "none";
				div_map.style.display = "block";
				//Slide out Map
				$('#DivMap').animate({
					right: '100%'
				},"slow");
				//Slide in Attitude
				div_attitude.style.right = "-100%"; 
				$('#DivAttitude').animate({
					right: '0'
				},"slow");
				new_vis = enum_visualizations.ATTITUDE;
			}else{
				error("ERROR: nextVisualization(): the current visualization enum is not recognized.");
			}
			global_current_visualization = new_vis;
			updateLeds();
		}
		function switchMissionsListStatus(){
			if(global_missions_list_is_open){
				$('#DivMissions').animate({
					left: '-300px'
				},"slow");
			}else{
				$('#DivMissions').animate({
					left: '0px'
				},"slow");
			}
			global_missions_list_is_open = !global_missions_list_is_open;
		}
		
		function switchInfoPanel(){
			var div_info_panel = document.getElementById("DivInfoPanel");
			var div_info_panel1 = document.getElementById("DivInfoPanel1");
			var div_info_panel2 = document.getElementById("DivInfoPanel2");
			if(global_menus.info_panel.isOpen){
				div_info_panel.className = "InfoPanelClosed";
				div_info_panel1.className = "InfoPanelInvisible";
				div_info_panel2.className = "InfoPanelInvisible";
			}else{
				div_info_panel.className = "InfoPanelOpened";
				div_info_panel1.className = "InfoPanelVisible";
				div_info_panel2.className = "InfoPanelVisible";
			}
			global_menus.info_panel.isOpen = !global_menus.info_panel.isOpen;
		}
		
		function switchGlobalMenu(){
			//var div_global_menu = document.getElementById("DivConfig");
			if(global_menus.global.isOpen){
				$( "#DivConfigBackground" ).fadeOut( "slow", function() {
					// Animation complete.
				  });
				//div_global_menu.className = "DivConfigClosed";
			}else{
				$( "#DivConfigBackground" ).fadeIn( "slow", function() {
					// Animation complete.
				  });
				//div_global_menu.className = "DivConfigOpened";
			}
			global_menus.global.isOpen = !global_menus.global.isOpen;
		}
		
		function closeMissionEditor(){
			if(global_menus.mission.isOpen){
				$( "#MissionEditorBackground" ).fadeOut( "slow", function() {
					// Animation complete.
				  });
				global_menus.mission.isOpen = !global_menus.mission.isOpen;
			}
		}
		
		function openMissionEditor(id){
			db.transaction(function (tx) {
				tx.executeSql('SELECT * FROM missions WHERE id = '+global_missions.active+';', [], function (tx, results) {	
					if(!global_menus.mission.isOpen){
						if(id == -1){//Create mode
							var mission = new Mission();
							updateMissionEditor(mission,id);
							$( "#MissionEditorBackground" ).fadeIn( "slow", function() {
								// Animation complete.
							  });
							global_menus.mission.isOpen = !global_menus.mission.isOpen;
						}else if(id == global_missions.selected){
							alert("Cannot edit the simulation selected mission, select another one!");
						}else{//Edit Mode
							var mission = JSON.parse(results.rows.item(0).json);
							updateMissionEditor(mission,id);
							$( "#MissionEditorBackground" ).fadeIn( "slow", function() {
								// Animation complete.
							  });
							global_menus.mission.isOpen = !global_menus.mission.isOpen;
						}
					}
				}, errorDatabaseHandler);
			});
		}
		
		function updateInfoPanel(force){
			if(global_menus.info_panel.isOpen || force){
				var results = global_simulation.results.info_panel;
				var ip_roll = document.getElementById("IpRoll");
				var ip_pitch = document.getElementById("IpPitch");
				var ip_yaw = document.getElementById("IpYaw");
				var ip_vel = document.getElementById("IpVel");
				var ip_accel = document.getElementById("IpAccel");
				var ip_mass = document.getElementById("IpMass");
				var ip_radius = document.getElementById("IpRadius");
				
				ip_roll.innerHTML = results.attitude.roll.toPrecision(3)+"°";
				ip_pitch.innerHTML = results.attitude.pitch.toPrecision(3)+"°";
				ip_yaw.innerHTML = results.attitude.yaw.toPrecision(3)+"°";
				ip_vel.innerHTML = results.velocity.toPrecision(3)+" Km/s";
				ip_accel.innerHTML = results.acceleration.toPrecision(3)+" Km/s2";
				ip_mass.innerHTML = results.mass.toPrecision(4)+" Kg";
				ip_radius.innerHTML = results.orb_radius.toPrecision(6)+" Km";
			}
		}
		
		function updateMissionEditor(mission,mission_id){
			var field;
			field = document.getElementById("mis-Id");
			field.value = mission_id;
			
			field = document.getElementById("mis-Title");
			if(mission_id == -1){
				field.innerHTML = "Create Mission";
			}else{
				field.innerHTML = "Edit Mission";
			}
			field = document.getElementById("mis-Name");
			field.value = mission.name;
			field = document.getElementById("mis-Description");
			field.value = mission.description;
			field = document.getElementById("mis-Mass");
			field.value = mission.initial_mass;
			
			
			
			field = document.getElementById("mis-Date");
			field.value = mission.initial_date.year+"/"+mission.initial_date.month+"/"+mission.initial_date.day;
			field = document.getElementById("mis-Time");
			field.value = mission.initial_date.hour+":"+mission.initial_date.minute;
			
			$('.datepicker').pickadate({
				clear: '',
				format: 'yyyy/mm/dd',
				formatSubmit: 'yyyy/m/d'
			});
			$('.timepicker').pickatime({
				clear: '',
				format: 'HH:i',
				formatLabel: 'HH:i',
				formatSubmit: 'H:i'
			});
			
			field = document.getElementById("mis-Duration");
			field.value = mission.duration;
			field = document.getElementById("mis-Speed");
			field.value = mission.step*parameters.simulator_target_fps;
			field = document.getElementById("mis-a");
			field.value = mission.initial_orbit.a;
			field = document.getElementById("mis-e");
			field.value = mission.initial_orbit.e;
			field = document.getElementById("mis-i");
			field.value = mission.initial_orbit.i;
			field = document.getElementById("mis-omega");
			field.value = mission.initial_orbit.omega;
			field = document.getElementById("mis-raan");
			field.value = mission.initial_orbit.raan;
			field = document.getElementById("mis-lm");
			field.value = mission.initial_orbit.lM;
		}
		
		function saveMissionEditor(){
			try{
				var field;
				
				var mission = new Mission();
				
				field = document.getElementById("mis-Name");
				mission.name = field.value;
				field = document.getElementById("mis-Description");
				mission.description = field.value;
				field = document.getElementById("mis-Mass");
				mission.initial_mass = field.value;
				
				field = document.getElementById("mis-Date");
				var dates = field.value.split('/');
				mission.initial_date.year = Number(dates[0]);
				mission.initial_date.month = Number(dates[1]);
				mission.initial_date.day = Number(dates[2]);
				field = document.getElementById("mis-Time");
				var times = field.value.split(':');
				mission.initial_date.hour = Number(times[0]);
				mission.initial_date.minute = Number(times[1]);
				
				field = document.getElementById("mis-Duration");
				mission.duration = Number(field.value);
				field = document.getElementById("mis-Speed");
				mission.step = Number(field.value)/parameters.simulator_target_fps;
				
				
				field = document.getElementById("mis-a");
				mission.initial_orbit.a = Number(field.value);
				field = document.getElementById("mis-e");
				mission.initial_orbit.e = Number(field.value);
				field = document.getElementById("mis-i");
				mission.initial_orbit.i = Number(field.value);
				field = document.getElementById("mis-omega");
				mission.initial_orbit.omega = Number(field.value);
				field = document.getElementById("mis-raan");
				mission.initial_orbit.raan = Number(field.value);
				field = document.getElementById("mis-lm");
				mission.initial_orbit.lM = Number(field.value);
				
				field = document.getElementById("mis-Id");
				var id = Number(field.value);
				if(id == -1){//Create mode
					addMissionToDb(mission);
				}else{//Edit mode
					editMissionToDb(id,mission);
				}
				
			}catch(err){
				alert("Format error");
			}
		}
		
	</script>
</head>
<body>

<div id="Splash">
	<div id="SplashLoading">Starting Stavor...</div>
</div>


<div id="DivMap" >
	<div id="map" ></div>
	<div id="MaptabContainer" class="tabContainer">
		<div id="Maptabs" class="tabs">
		  <ul>
			<li id="MaptabHeader_1">Coverage</li>
			<li id="MaptabHeader_2">Stations</li>
			<li id="MaptabHeader_3">Models</li>
		  </ul>
		</div>
		<div id="Maptabscontent" class="tabscontent">
		  <div class="tabpage" id="Maptabpage_1">
			<h4>Payload</h4>
			
		  </div>
		  <div class="tabpage" id="Maptabpage_2">
			<h4>Ground stations</h4>
			
		  </div>
		  <div class="tabpage" id="Maptabpage_3">
			<h4>Satellite</h4>
			<h4>Sun</h4>
			
		  </div>
		</div>
	</div>
	<div id="MenuButtonMap" class="MenuButton" onclick="switchMapMenu()" ></div>
	<div id="ViewButtonMap" class="ViewButton" onclick="" ></div>
</div>
<div id="DivOrbit" >
	<div id="orbit" ></div>
	<div id="OrbittabContainer" class="tabContainer">
		<div id="Orbittabs" class="tabs">
		  <ul>
			<li id="OrbittabHeader_1">Models</li>
		  </ul>
		</div>
		<div id="Orbittabscontent" class="tabscontent">
		  <div class="tabpage" id="Orbittabpage_1">
			<h4>General</h4>
			<p>Show sky:<input id="opt-orb-ShowSky" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<p>Show axis:<input id="opt-orb-ShowAxis" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<p>Show axis labels:<input id="opt-orb-ShowAxisLabels" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<h4>Earth</h4>
			<p>Show Earth model:<input id="opt-orb-ShowEarthModel" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<p>&bull;Show Earth axis:<input id="opt-orb-ShowEarthAxis" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<p>&bull;Show Earth atmosphere:<input id="opt-orb-ShowEarthAtmosphere" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<p>&bull;Show Earth clouds:<input id="opt-orb-ShowEarthClouds" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<h4>Reference</h4>
			<p>Show XY plane:<input id="opt-orb-ShowXyPlane" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<p>Color:<input id="opt-orb-PlaneXyColor" class="color" style="float: right;" onchange="updateOrbitOption(this.id,this.value)"/></p>
			<h4>Spacecraft</h4>
			<p>Show spacecraft:<input id="opt-orb-ShowSpacecraft" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<p>Color:<input id="opt-orb-SpacecraftColor" class="color" style="float: right;" onchange="updateOrbitOption(this.id,this.value)"/></p>
			<h4>Orbit</h4>
			<p>Show projection:<input id="opt-orb-ShowProjection" type="checkbox" style="float: right;" onchange="updateOrbitOption(this.id,this.checked)"/></p>
			<p>Color:<input id="opt-orb-OrbitColor" class="color" style="float: right;" onchange="updateOrbitOption(this.id,this.value)"/></p>
		  </div>
		</div>
	</div>
	<div id="MenuButtonOrbit" class="MenuButton" onclick="switchOrbitMenu()" ></div>
	<div id="ViewButtonOrbit" class="ViewButton" onclick="" ></div>
</div>
<div id="DivAttitude" >
	<div id="attitude" ></div>
	<div id="AttitudetabContainer" class="tabContainer">
		<div id="Attitudetabs" class="tabs">
		  <ul>
			<li id="AttitudetabHeader_1">Indicators</li>
			<li id="AttitudetabHeader_2">Measures</li>
			<li id="AttitudetabHeader_3">Models</li>
		  </ul>
		</div>
		<div id="Attitudetabscontent" class="tabscontent">
		  <div class="tabpage" id="Attitudetabpage_1">
			<h4>Basic</h4>
			<h5>Velocity</h5>
			<p>Show velocity:<input id="opt-att-ShowVelocity" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Limit (Km/s):<input id="opt-att-LimitVelocity" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Color:<input id="opt-att-VelocityColor" class="color" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<h5>Acceleration</h5>
			<p>Show acceleration:<input id="opt-att-ShowAcceleration" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Limit (Km/s2):<input id="opt-att-LimitAcceleration" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Color:<input id="opt-att-AccelerationColor" class="color" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<h5>Momentum</h5>
			<p>Show momentum:<input id="opt-att-ShowMomentum" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Color:<input id="opt-att-MomentumColor" class="color" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<h4>Extra</h4>
			<h5>Target</h5>
			<p>Show target:<input id="opt-att-ShowTarget" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>X:<input id="opt-att-TargetValueX" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Y:<input id="opt-att-TargetValueY" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Z:<input id="opt-att-TargetValueZ" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Color:<input id="opt-att-TargetColor" class="color" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<h5>Vector</h5>
			<p>Show vector:<input id="opt-att-ShowVector" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Limit:<input id="opt-att-LimitVector" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>X:<input id="opt-att-VectorValueX" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Y:<input id="opt-att-VectorValueY" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Z:<input id="opt-att-VectorValueZ" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Color:<input id="opt-att-VectorColor" class="color" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<h5>Direction</h5>
			<p>Show direction:<input id="opt-att-ShowDirection" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>X:<input id="opt-att-DirectionValueX" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Y:<input id="opt-att-DirectionValueY" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Z:<input id="opt-att-DirectionValueZ" type="number" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Color:<input id="opt-att-DirectionColor" class="color" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
		  </div>
		  <div class="tabpage" id="Attitudetabpage_2">
			<h4>Inclination</h4>
			<p>Show planes:<input id="opt-att-ShowOrbitalPlane" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>&bull;Show inclination:<input id="opt-att-ShowInclination" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<!--<p>Show Earth rotation plane:<input id="opt-att-ShowEarthPlane" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>-->
			<p>Rotation plane color:<input id="opt-att-RotationPlaneColor" class="color" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>Orbital plane color:<input id="opt-att-OrbitalPlaneColor" class="color" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<h4>Spheric coordinates</h4>
			<p>Show spheric coordinates:<input id="opt-att-ShowSphericCoordinates" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<select id="opt-att-SphericCoordsSelection" onchange="updateAttitudeOption(this.id,this.value)">
				<option value="0">VELOCITY</option>
				<option value="1">ACCELERATION</option>
				<option value="2">MOMENTUM</option>
				<option value="3">EARTH</option>
				<option value="4">SUN</option>
			</select>
			<h4>Angles</h4>
			<p>Show vectors angle:<input id="opt-att-ShowVectorsAngle" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<select id="opt-att-AnglesSelection1" onchange="updateAttitudeOption(this.id,this.value)">
				<option value="0">VELOCITY</option>
				<option value="1">ACCELERATION</option>
				<option value="2">MOMENTUM</option>
				<option value="3">EARTH</option>
				<option value="4">SUN</option>
			</select>
			<select id="opt-att-AnglesSelection2" onchange="updateAttitudeOption(this.id,this.value)">
				<option value="0">VELOCITY</option>
				<option value="1">ACCELERATION</option>
				<option value="2">MOMENTUM</option>
				<option value="3">EARTH</option>
				<option value="4">SUN</option>
			</select>
		  </div>
		  <div class="tabpage" id="Attitudetabpage_3">
			<h4>General</h4>
			<p>Show sky:<input id="opt-att-ShowSky" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Show axis:<input id="opt-att-ShowAxis" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Show axis labels:<input id="opt-att-ShowAxisLabels" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<h4>Reference</h4>
			<p>Show ref. sphere:<input id="opt-att-ShowSphere" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Show mini spheres:<input id="opt-att-ShowMiniSpheres" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Show circles:<input id="opt-att-ShowCircles" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<h4>Spacecraft</h4>
			<p>Show spacecraft axis:<input id="opt-att-ShowScAxis" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Show engine texture:<input id="opt-att-ShowEngineTexture" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<h4>Sun</h4>
			<p>Show model:<input id="opt-att-ShowSunModel" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>&bull;Show surface:<input id="opt-att-ShowSunSurface" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>&bull;Sun rotates:<input id="opt-att-SunRotates" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Rotation speed [0-9]:<input id="opt-att-SunRotationSpeed" type="number" min="0" max="9" step="1" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>&bull;Show line:<input id="opt-att-ShowSunLine" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>&bull;Show distance:<input id="opt-att-ShowSunDistance" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<h4>Earth</h4>
			<p>Show model:<input id="opt-att-ShowEarthModel" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>&bull;Show surface:<input id="opt-att-ShowEarthSurface" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>&bull;Earth rotates:<input id="opt-att-EarthRotates" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>Rotation speed [0-9]:<input id="opt-att-EarthRotationSpeed" type="number" min="0" max="9" step="1" style="float: right;" onchange="updateAttitudeOption(this.id,this.value)"/></p>
			<p>&bull;Show line:<input id="opt-att-ShowEarthLine" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
			<p>&bull;Show distance:<input id="opt-att-ShowEarthDistance" type="checkbox" style="float: right;" onchange="updateAttitudeOption(this.id,this.checked)"/></p>
		  </div>
		</div>
	</div>
	<div id="MenuButtonAttitude" class="MenuButton" onclick="switchAttitudeMenu()" ></div>
	<div id="ViewButtonAttitude" class="ViewButton" onclick="" ></div>
</div>

<div id="ConfigButton" class="ConfigButton" onclick="switchGlobalMenu()" ></div>
<div id="DivInfoPanel" class="InfoPanelClosed" onclick="switchInfoPanel()">
	<div id="DivInfoPanel1" class="InfoPanelInvisible">
		<div class="InfoPanelTop" >
			<table class="EqColomTable"><tr><td>
				<table class="InfoPanelField"><tr><td>
				Roll: 
				</td><td align="right" id="IpRoll">
				0.00° 
				</td></tr></table>
			</td><td>
				<table class="InfoPanelField"><tr><td>
				Pitch: 
				</td><td align="right" id="IpPitch">
				0.00° 
				</td></tr></table>
			</td><td>
				<table class="InfoPanelField"><tr><td>
				Yaw: 
				</td><td align="right" id="IpYaw">
				0.00° 
				</td></tr></table>
			</td></tr></table>
		</div>
		<div class="InfoPanelBottom" >
			<table class="InfoPanelField"><tr><td style="padding-left:5px">
			Mass: 
			</td><td align="right" style="padding-right:5px" id="IpMass">
			0.00 Kg 
			</td></tr></table>
		</div>
	</div>
	<div id="DivInfoPanel2" class="InfoPanelInvisible">
		<div class="InfoPanelTop" >
			<table class="EqColomTable"><tr><td>
				<table class="InfoPanelField"><tr><td>
				Vel.: 
				</td><td align="right" id="IpVel">
				0.00 Km/s 
				</td></tr></table>
			</td><td>
				<table class="InfoPanelField"><tr><td>
				Accel.: 
				</td><td align="right" id="IpAccel">
				0.00 Km/m2 
				</td></tr></table>
			</td></tr></table>
		</div>
		<div class="InfoPanelBottom" >
			<table class="InfoPanelField"><tr><td style="padding-left:5px">
			Orb. radius: 
			</td><td align="right" style="padding-right:5px" id="IpRadius">
			0.00 Km
			</td></tr></table>
		</div>
	</div>
</div>

<div id="DivMissions">
	<input id="MissionsListClose" class="" type="image" src="style/icons/close.png" title="Close mission list" onclick="switchMissionsListStatus()"/>
	<h3 id="TitleMissions">Missions</h3>	
	<div id="ListMissions">
		<ol id="olListMissions">
		  <li id="0" class="MissionNormal" onclick="onMissionClicked(this.id)">Coffee</li>
		  <li class="MissionActive">Milk</li>
		  <li class="MissionSelected">Coffee</li>
		  <li class="MissionActiveSelected">Milk</li>
		  <li id="0" class="MissionNormal" onclick="onMissionClicked(this.id)">Milk</li>
		  <li id="0" class="MissionNormal" onclick="onMissionClicked(this.id)">Coffeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee</li>
		  <li id="0" class="MissionNormal" onclick="onMissionClicked(this.id)">Milk</li>
		  <li id="0" class="MissionNormal" onclick="onMissionClicked(this.id)">Coffee</li>
		  <li id="0" class="MissionNormal" onclick="onMissionClicked(this.id)">Milk</li>
		</ol>
	</div>
	<div id="MissionsMenu">
		<div class="MissionsMenuItem"><input class="MissionsMenuButton" type="image" src="style/icons/select.png" title="Select Mission" onclick="onSelectMissionButtonClicked()"/></div>
		<div class="MissionsMenuItem"><input class="MissionsMenuButton" type="image" src="style/icons/new.png" title="Create Mission" onclick="openMissionEditor(-1)"/></div>
		<div class="MissionsMenuItem"><input class="MissionsMenuButton" type="image" src="style/icons/edit.png" title="Edit Mission" onclick="openMissionEditor(global_missions.active)"/></div>
		<div class="MissionsMenuItem"><input class="MissionsMenuButton" type="image" src="style/icons/delete.png" title="Remove Mission" onclick="onDeleteMissionButtonClicked()"/></div>
	</div>
</div>

<div id="MissionEditorBackground">
	<div id="MissionEditor">
		<div id="MissionCloseButton" onclick="closeMissionEditor()"></div>
		<div id="MissionConfirmButton" onclick="saveMissionEditor()"></div>
			<h3 id="mis-Title">Edit mission</h3>
		<div id="MissionEditorContent">
			<input id="mis-Id" type="hidden"/>
			<p>Name:<input id="mis-Name" type="text" style="float: right;"/></p>
			<p>Desription:<input id="mis-Description" type="text" style="float: right;"/></p>
			<p>Initial mass (Kg):<input id="mis-Mass" type="number" min="0" style="float: right;"/></p>
			<h4>Simulation</h4>
			<!-- Date picker -->
			<p>Date:<input id="mis-Date" class="datepicker" style="float: right;"/></p>
			<p>Time:<input id="mis-Time" class="timepicker" style="float: right;"/></p>
			<p>Duration (s):<input id="mis-Duration" type="number" min="0" style="float: right;"/></p>
			<p>Speed (s'/s):<input id="mis-Speed" type="number" min="0" style="float: right;"/></p>
			<h4>Attitude</h4>
			<p>Attitude control:<select id="mis-AttitudeProvider" style="float: right;">
				<option value="0">INERTIAL</option>
				<option value="1">FACING_EARTH</option>
				<option value="2">FACING_SUN</option>
			</select></p>
			<h4>Orbit</h4>
			<p>Semi-major axis (m):<input id="mis-a" type="number" min="0" step="any" style="float: right;"/></p>
			<p>Eccentricity:<input id="mis-e" type="number" min="0" step="any" style="float: right;"/></p>
			<p>Inclination (rad):<input id="mis-i" type="number" step="any" style="float: right;"/></p>
			<p>Arg. Perigee (rad):<input id="mis-omega" type="number" step="any" style="float: right;"/></p>
			<p>RAAN (rad):<input id="mis-raan" type="number" step="any" style="float: right;"/></p>
			<p>Mean anomaly (rad):<input id="mis-lm" type="number" step="any" style="float: right;"/></p>
		</div>
	</div>
</div>

<div id="SlidePrev" onclick="prevVisualization()" ></div>
<div id="SlideNext" onclick="nextVisualization()" ></div>

<div id="DivConfigBackground">
	<div id="DivConfig">
		<div id="ConfigCloseButton" onclick="switchGlobalMenu()"></div>
		<h3>Configuration</h3>
		<p>3D Detail level [1-9]:<input id="opt-glo-PerformanceLevel" type="number" min="1" max="9" step="1" style="float: right;" onchange="updateGlobalOption(this.id,this.value)"/></p>
		<p>Show FPS:<input id="opt-glo-ShowFps" type="checkbox" style="float: right;" onchange="updateGlobalOption(this.id,this.checked)"/></p>
		<p><input id="ResetConfigButton" value="Reset all configuration" type="button" onclick="resetConfiguration()" class="stavorDarkButton"/></p>
		<p><input id="ResetMissionsButton" value="Reset missions database" type="button" onclick="resetMissionsDb()" class="stavorDarkButton"/></p>
	</div>
</div>
	
<div id="DivToolbar" >
	<input id="PlayButton" class="SimControl" type="image" src="style/icons/play.png" title="Play/Pause simulator"/>
	<input id="StopButton" class="SimControl" type="image" src="style/icons/stop.png" title="Stop simulator"/>
	<input id="TimeBar" type="range" min="0" max="100" value="0"  title="Simulation time"/><!--disabled="true"-->
	<input id="AccelButton" class="SimControlLeft" type="image" src="style/icons/accelerate.png" title="Accelerate simulation"/>
	<input id="SlowButton" class="SimControlRight" type="image" src="style/icons/slow.png" title="Slow down simulation"/>&nbsp;
	<input id="ReverseButton" class="SimControlLeft" type="image" src="style/icons/reverse.png" title="Reverse simulation"/>
	<input id="ForwardButton" class="SimControlRight" type="image" src="style/icons/forward.png" title="Forward simulation"/>&nbsp;&nbsp;
</div>
<div id="DivClock" >
	<input id="MissionsListButton" class="" type="image" src="style/icons/list.png" title="Mission list" onclick="switchMissionsListStatus()"/>&nbsp;2014-01-01 20:00:33.1 UTC&nbsp;
</div>
<div id="LedMap" class="Led LedUnselected" />
<div id="LedOrbit" class="Led LedUnselected"/>
<div id="LedAttitude" class="Led LedUnselected"/>


<!-- Modules -->
	<!-- Attitude -->
	<script type='text/javascript' src="modules/attitude/attitude.js"></script>
	<!-- Orbit -->
	<script type='text/javascript' src="modules/orbit/orbit.js"></script>
	<!-- Map -->
	<script type='text/javascript' src="modules/map/map.js"></script>
	

<!-- PickDate -->
	<script type="text/javascript" src="js/PickDate/picker.js"></script>
	<script type="text/javascript" src="js/PickDate/picker.date.js"></script>
	<script type="text/javascript" src="js/PickDate/picker.time.js"></script>
	<link rel="stylesheet" href="js/PickDate/themes/default.css"/>
	<link rel="stylesheet" href="js/PickDate/themes/default.date.css"/>
	<link rel="stylesheet" href="js/PickDate/themes/default.time.css"/>
</body>
</html>
